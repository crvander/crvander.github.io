---
layout: post
title: Project 3
image: 
  path: /assets/img/blog/jeremy-bishop@0,5x.jpg
# description: >
#   Version 9 is the most complete version of Hydejack yet.
#   Modernized design, big headlines, and big new features.
sitemap: true
---

<!-- Version 9 is the most complete version of Hydejack yet.
{:.lead}

[Modernized](#linking-in-style) [design](#whats-in-the-cards), [big headlines](#ready-for-the-big-screen), big new features: [Built-In Search](#built-in-search), [Sticky Table of Contents](#sticky-table-of-contents), and [Auto-Hiding Navbar](#auto-hiding-navbar). That [and more](#and-much-more) is Hydejack 9.

- Table of Contents
{:toc .large-only} -->

### Hi there

This is a test article.

---
jupyter:
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.11.9
  nbformat: 4
  nbformat_minor: 2
---

::: {.cell .code execution_count="858"}
``` python
import pandas as pd
import numpy as np
import json
```
:::

::: {.cell .code execution_count="859"}
``` python
# CuratedOfferOptions.csv:
# CurationProvider: in quotes
# OfferId: in quotes
# DealerId: in quotes
# UniqueOptionId: in quotes
# OptionId: in quotes
# IsMobileDealer: without quotes
# IsOpen: without quotes
# Eta: in quotes
# ChamaScore: without quotes
# ProductBrand: in quotes
# IsWinner: without quotes
# MinimumPrice: without quotes
# MaximumPrice: without quotes
# DynamicPrice: without quotes
# FinalPrice: without quotes
# DefeatPrimaryReason: in quotes
# DefeatReasons: in quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

# DynamicPriceOption.csv:
# Provider: in quotes
# OfferId: in quotes
# UniqueOptionId: in quotes
# BestPrice: without quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

# DynamicPriceRange.csv:
# Provider: in quotes
# OfferId: in quotes
# MinGlobal: without quotes
# MinRecommended: without quotes
# MaxRecommended: without quotes
# DifferenceMinRecommendMinTheory: without quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)
```
:::

::: {.cell .code execution_count="860"}
``` python
df=pd.read_json('case.json')
df.head()
```

::: {.output .execute_result execution_count="860"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeUtc</th>
      <th>EventName</th>
      <th>Payload</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-09-05 08:04:08 UTC</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-08-18 11:43:23 UTC</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPricePerOption","offe...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-09-05 09:04:04 UTC</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-08-25 05:02:55 UTC</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"149f...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-09-05 08:03:28 UTC</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="861"}
``` python
df['EnqueuedTimeUtc'] = pd.to_datetime(df['EnqueuedTimeUtc']).dt.tz_convert('America/Sao_Paulo')
df['EnqueuedTimeUtc'] = df['EnqueuedTimeUtc'].dt.strftime('%d/%m/%Y')
df.rename(columns={'EnqueuedTimeUtc': 'EnqueuedTimeSP'}, inplace=True)
df.head()
```

::: {.output .execute_result execution_count="861"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>EventName</th>
      <th>Payload</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPricePerOption","offe...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"149f...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="862"}
``` python
# DYNAMIC DF
df_dynamic = df[df['EventName'] == 'DynamicPrice_Result']

# CURATE DF
df_curate = df[df['EventName'] == 'CurateOffer_Result']
```
:::

::: {.cell .code execution_count="863"}
``` python
df_dynamic.head()
```

::: {.output .execute_result execution_count="863"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>EventName</th>
      <th>Payload</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPricePerOption","offe...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPriceRange","offerId"...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18/08/2021</td>
      <td>DynamicPrice_Result</td>
      <td>{"provider":"ApplyDynamicPricePerOption","offe...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="864"}
``` python
json.loads(df_dynamic.Payload.iloc[0])
```

::: {.output .execute_result execution_count="864"}
    {'provider': 'ApplyDynamicPriceRange',
     'offerId': 'a6611d55-9624-4381-8cdd-323ee3689241',
     'algorithmOutput': {'min_global': 85.0,
      'min_recommended': 87.2,
      'max_recommended': 97.65,
      'differenceMinRecommendMinTheory': 2.2}}
:::
:::

::: {.cell .code execution_count="865"}
``` python
# a=pd.json_normalize(df_dynamic.Payload.apply(lambda x: json.loads(x)))
# a.head()
```
:::

::: {.cell .code execution_count="866"}
``` python
payload = df_dynamic['Payload'].apply(lambda x: pd.Series(json.loads(x)))
payload.head()
```

::: {.output .execute_result execution_count="866"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>00991873-194e-4a6e-89c9-8f68668b6aaa</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="867"}
``` python
(df_dynamic.shape, payload.shape)
```

::: {.output .execute_result execution_count="867"}
    ((32, 3), (32, 3))
:::
:::

::: {.cell .code execution_count="868"}
``` python
df_dynamic = pd.concat([df_dynamic, payload], axis=1).drop(['Payload', 'EventName'], axis=1)
df_dynamic.head()
```

::: {.output .execute_result execution_count="868"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>00991873-194e-4a6e-89c9-8f68668b6aaa</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="869"}
``` python
# DynamicPriceOption
df_dynamic_option = df_dynamic[df_dynamic['provider'] == 'ApplyDynamicPricePerOption']

# DynamicPriceRange
df_dynamic_range = df_dynamic[df_dynamic['provider'] == 'ApplyDynamicPriceRange']
```
:::

::: {.cell .code execution_count="870"}
``` python
df_dynamic_option.head()
```

::: {.output .execute_result execution_count="870"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>00991873-194e-4a6e-89c9-8f68668b6aaa</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>00991873-194e-4a6e-89c9-8f68668b6aaa</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>7a471a13-7922-4e7a-9667-9b2f96b44a2a</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>7cb20a39-c7f9-4c4c-9d51-94dbb8c4ff07</td>
      <td>[{'uniqueOptionId': '9c4ec643-934f-56d1-198d-4...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="871"}
``` python
df_dynamic_option.algorithmOutput.iloc[0]
```

::: {.output .execute_result execution_count="871"}
    [{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
      'bestPrice': 92.45},
     {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
      'bestPrice': 92.45},
     {'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33985ae3ecda',
      'bestPrice': 92.45},
     {'uniqueOptionId': '151e59ac-761a-96f5-d2b9-882037a9fd28', 'bestPrice': 94.6},
     {'uniqueOptionId': '3cd346f4-d297-7568-2e50-d43a8e2fd0a9', 'bestPrice': 94.6},
     {'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3369c29db1d', 'bestPrice': 93.0},
     {'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e70072a05229', 'bestPrice': 93.0},
     {'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b352ec251f3',
      'bestPrice': 91.35}]
:::
:::

::: {.cell .code execution_count="872"}
``` python
df_dynamic_option = df_dynamic_option.explode('algorithmOutput')
df_dynamic_option.head()
```

::: {.output .execute_result execution_count="872"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="873"}
``` python
# pd.json_normalize(df_dynamic_option.algorithmOutput).shape
```
:::

::: {.cell .code execution_count="874"}
``` python
# df_dynamic_option_alg = df_dynamic_option['algorithmOutput'].apply(lambda x: pd.Series(x))
# df_dynamic_option_alg.head()
```
:::

::: {.cell .code execution_count="875"}
``` python
# df_dynamic_option = pd.merge(df_dynamic_option, df_dynamic_option_alg, left_index=True, right_index=True).drop('algorithmOutput', axis=1)
# df_dynamic_option
```
:::

::: {.cell .code execution_count="876"}
``` python
df_dynamic_option_alg = pd.json_normalize(df_dynamic_option.algorithmOutput)
df_dynamic_option_alg.head()
```

::: {.output .execute_result execution_count="876"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uniqueOptionId</th>
      <th>bestPrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>1</th>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>3</th>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>94.60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>94.60</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="877"}
``` python
df_dynamic_option.reset_index(drop=True, inplace=True)
df_dynamic_option = pd.concat([df_dynamic_option, df_dynamic_option_alg], axis=1).drop('algorithmOutput', axis=1)
df_dynamic_option.head()
```

::: {.output .execute_result execution_count="877"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>uniqueOptionId</th>
      <th>bestPrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>92.45</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>94.60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18/08/2021</td>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>94.60</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="878"}
``` python
df_dynamic_option.columns
```

::: {.output .execute_result execution_count="878"}
    Index(['EnqueuedTimeSP', 'provider', 'offerId', 'uniqueOptionId', 'bestPrice'], dtype='object')
:::
:::

::: {.cell .code execution_count="879"}
``` python
new_column_order = ['provider', 'offerId', 'uniqueOptionId', 'bestPrice', 'EnqueuedTimeSP']
df_dynamic_option = df_dynamic_option[new_column_order]
df_dynamic_option.head()
```

::: {.output .execute_result execution_count="879"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provider</th>
      <th>offerId</th>
      <th>uniqueOptionId</th>
      <th>bestPrice</th>
      <th>EnqueuedTimeSP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>92.45</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>92.45</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>92.45</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>94.60</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ApplyDynamicPricePerOption</td>
      <td>56e0702c-0218-4626-8d3d-ae9d54b4503b</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>94.60</td>
      <td>18/08/2021</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="880"}
``` python
# final df_dinamic_option df
# Provider: in quotes
# OfferId: in quotes
# UniqueOptionId: in quotes
# BestPrice: without quotes
# EnqueuedTimeSP: DD/MM/YYYY
# df_dynamic_option.drop('EventName', axis=1, inplace=True)
# df_dynamic_range.provider.apply(lambda x: "\""+x+"\"")
# df_dynamic_option.head()
```
:::

::: {.cell .code execution_count="881"}
``` python
for idx, val in enumerate(df_dynamic_option.columns):
    if idx == 4:
        break
    df_dynamic_option[val]=df_dynamic_option[val].apply(lambda x: '\"'+str(x)+'\"')

df_dynamic_option.head()
```

::: {.output .execute_result execution_count="881"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provider</th>
      <th>offerId</th>
      <th>uniqueOptionId</th>
      <th>bestPrice</th>
      <th>EnqueuedTimeSP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"ApplyDynamicPricePerOption"</td>
      <td>"56e0702c-0218-4626-8d3d-ae9d54b4503b"</td>
      <td>"b0e296a9-0590-f0e0-8211-243a2ededb12"</td>
      <td>"92.45"</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"ApplyDynamicPricePerOption"</td>
      <td>"56e0702c-0218-4626-8d3d-ae9d54b4503b"</td>
      <td>"d6562c24-0b37-5fb4-8275-65b7b8b47b87"</td>
      <td>"92.45"</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"ApplyDynamicPricePerOption"</td>
      <td>"56e0702c-0218-4626-8d3d-ae9d54b4503b"</td>
      <td>"8d0f9262-f543-d0c8-a869-33985ae3ecda"</td>
      <td>"92.45"</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"ApplyDynamicPricePerOption"</td>
      <td>"56e0702c-0218-4626-8d3d-ae9d54b4503b"</td>
      <td>"151e59ac-761a-96f5-d2b9-882037a9fd28"</td>
      <td>"94.6"</td>
      <td>18/08/2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"ApplyDynamicPricePerOption"</td>
      <td>"56e0702c-0218-4626-8d3d-ae9d54b4503b"</td>
      <td>"3cd346f4-d297-7568-2e50-d43a8e2fd0a9"</td>
      <td>"94.6"</td>
      <td>18/08/2021</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="882"}
``` python
df_dynamic_range.head()
```

::: {.output .execute_result execution_count="882"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>329194f3-95a4-45ef-b3d0-2796f74ce2a0</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>fdcfde5c-113d-4a59-9ae0-8bc31e2943d8</td>
      <td>{'min_global': 87.35, 'min_recommended': 89.25...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="883"}
``` python
df_dynamic_range['algorithmOutput'].iloc[0]
```

::: {.output .execute_result execution_count="883"}
    {'min_global': 85.0,
     'min_recommended': 87.2,
     'max_recommended': 97.65,
     'differenceMinRecommendMinTheory': 2.2}
:::
:::

::: {.cell .code execution_count="884"}
``` python
df_dynamic_range.reset_index(inplace=True, drop=True)
df_dynamic_range.head()
```

::: {.output .execute_result execution_count="884"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>algorithmOutput</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>329194f3-95a4-45ef-b3d0-2796f74ce2a0</td>
      <td>{'min_global': 85.0, 'min_recommended': 87.2, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>fdcfde5c-113d-4a59-9ae0-8bc31e2943d8</td>
      <td>{'min_global': 87.35, 'min_recommended': 89.25...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="885"}
``` python
df_dynamic_range_alg = pd.json_normalize(df_dynamic_range['algorithmOutput'])
df_dynamic_range_alg.head()
```

::: {.output .execute_result execution_count="885"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_global</th>
      <th>min_recommended</th>
      <th>max_recommended</th>
      <th>differenceMinRecommendMinTheory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.35</td>
      <td>89.25</td>
      <td>99.95</td>
      <td>1.9</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="886"}
``` python
df_dynamic_range = pd.concat([df_dynamic_range, df_dynamic_range_alg], axis=1).drop('algorithmOutput', axis=1)
df_dynamic_range.head()
```

::: {.output .execute_result execution_count="886"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>provider</th>
      <th>offerId</th>
      <th>min_global</th>
      <th>min_recommended</th>
      <th>max_recommended</th>
      <th>differenceMinRecommendMinTheory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>329194f3-95a4-45ef-b3d0-2796f74ce2a0</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05/09/2021</td>
      <td>ApplyDynamicPriceRange</td>
      <td>fdcfde5c-113d-4a59-9ae0-8bc31e2943d8</td>
      <td>87.35</td>
      <td>89.25</td>
      <td>99.95</td>
      <td>1.9</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="887"}
``` python
df_dynamic_range.columns
```

::: {.output .execute_result execution_count="887"}
    Index(['EnqueuedTimeSP', 'provider', 'offerId', 'min_global',
           'min_recommended', 'max_recommended',
           'differenceMinRecommendMinTheory'],
          dtype='object')
:::
:::

::: {.cell .code execution_count="888"}
``` python
new_column_order = ['provider', 'offerId', 'min_global',
       'min_recommended', 'max_recommended',
       'differenceMinRecommendMinTheory', 'EnqueuedTimeSP']
df_dynamic_range = df_dynamic_range[new_column_order]
df_dynamic_range.head()
```

::: {.output .execute_result execution_count="888"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provider</th>
      <th>offerId</th>
      <th>min_global</th>
      <th>min_recommended</th>
      <th>max_recommended</th>
      <th>differenceMinRecommendMinTheory</th>
      <th>EnqueuedTimeSP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ApplyDynamicPriceRange</td>
      <td>a6611d55-9624-4381-8cdd-323ee3689241</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ApplyDynamicPriceRange</td>
      <td>b8c636fa-8241-47dc-ac40-bdf438a04d9c</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ApplyDynamicPriceRange</td>
      <td>3d32f7fb-396d-4d3f-b673-dea1f7dc41b7</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ApplyDynamicPriceRange</td>
      <td>329194f3-95a4-45ef-b3d0-2796f74ce2a0</td>
      <td>85.00</td>
      <td>87.20</td>
      <td>97.65</td>
      <td>2.2</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ApplyDynamicPriceRange</td>
      <td>fdcfde5c-113d-4a59-9ae0-8bc31e2943d8</td>
      <td>87.35</td>
      <td>89.25</td>
      <td>99.95</td>
      <td>1.9</td>
      <td>05/09/2021</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="889"}
``` python
for idx, val in enumerate(df_dynamic_range):
    if idx == 6:
        break
    df_dynamic_range[val] = df_dynamic_range[val].apply(lambda x: '\"'+str(x)+'\"')

df_dynamic_range.head()
```

::: {.output .execute_result execution_count="889"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provider</th>
      <th>offerId</th>
      <th>min_global</th>
      <th>min_recommended</th>
      <th>max_recommended</th>
      <th>differenceMinRecommendMinTheory</th>
      <th>EnqueuedTimeSP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"ApplyDynamicPriceRange"</td>
      <td>"a6611d55-9624-4381-8cdd-323ee3689241"</td>
      <td>"85.0"</td>
      <td>"87.2"</td>
      <td>"97.65"</td>
      <td>"2.2"</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"ApplyDynamicPriceRange"</td>
      <td>"b8c636fa-8241-47dc-ac40-bdf438a04d9c"</td>
      <td>"85.0"</td>
      <td>"87.2"</td>
      <td>"97.65"</td>
      <td>"2.2"</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"ApplyDynamicPriceRange"</td>
      <td>"3d32f7fb-396d-4d3f-b673-dea1f7dc41b7"</td>
      <td>"85.0"</td>
      <td>"87.2"</td>
      <td>"97.65"</td>
      <td>"2.2"</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"ApplyDynamicPriceRange"</td>
      <td>"329194f3-95a4-45ef-b3d0-2796f74ce2a0"</td>
      <td>"85.0"</td>
      <td>"87.2"</td>
      <td>"97.65"</td>
      <td>"2.2"</td>
      <td>05/09/2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"ApplyDynamicPriceRange"</td>
      <td>"fdcfde5c-113d-4a59-9ae0-8bc31e2943d8"</td>
      <td>"87.35"</td>
      <td>"89.25"</td>
      <td>"99.95"</td>
      <td>"1.9"</td>
      <td>05/09/2021</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="890"}
``` python
df_curate.head()
```

::: {.output .execute_result execution_count="890"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>EventName</th>
      <th>Payload</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"149f...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"c99a...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"d668...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"0a06...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>[{"curationProvider":"ByPrice","offerId":"135d...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="891"}
``` python
json.loads(df_curate.Payload.iloc[1])
```

::: {.output .execute_result execution_count="891"}
    [{'curationProvider': 'ByPrice',
      'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
      'dealerId': '6517',
      'options': [{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
        'optionId': '6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2',
        'isMobileDealer': True,
        'isOpen': True,
        'eta': '00:12:54.9215999',
        'chamaScore': 8.0,
        'productBrand': 'ULTRAGAZ',
        'isWinner': True,
        'minimumPrice': 90.0,
        'maximumPrice': 180.0,
        'dynamicPrice': 91.9,
        'finalPrice': 91.9},
       {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
        'optionId': '6517 || 6517',
        'isMobileDealer': False,
        'isOpen': True,
        'eta': '0:01',
        'chamaScore': 8.0,
        'productBrand': 'ULTRAGAZ',
        'isWinner': False,
        'minimumPrice': 90.0,
        'maximumPrice': 180.0,
        'dynamicPrice': 91.9,
        'finalPrice': 91.9,
        'defeatPrimaryReason': 'HasDriverInOffer',
        'defeatReasons': ['HasDriverInOffer']}]},
     {'curationProvider': 'ByPrice',
      'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
      'dealerId': '9047',
      'options': [{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33985ae3ecda',
        'optionId': '9047 || 9047 || ULTRAGAZ',
        'isMobileDealer': False,
        'isOpen': False,
        'eta': '1:00',
        'chamaScore': 9.0,
        'productBrand': 'ULTRAGAZ',
        'isWinner': False,
        'minimumPrice': 99.0,
        'maximumPrice': 198.0,
        'dynamicPrice': 99.95,
        'finalPrice': 99.95,
        'defeatPrimaryReason': 'Closed',
        'defeatReasons': ['Closed',
         'HigherPrice',
         'HasDriverInOffer',
         'HigherETA']},
       {'uniqueOptionId': '3cd346f4-d297-7568-2e50-d43a8e2fd0a9',
        'optionId': '9047 || 9047 || CONSIGAZ',
        'isMobileDealer': False,
        'isOpen': False,
        'eta': '1:00',
        'chamaScore': 9.0,
        'productBrand': 'CONSIGAZ',
        'isWinner': False,
        'minimumPrice': 89.99,
        'maximumPrice': 179.98,
        'dynamicPrice': 91.89,
        'finalPrice': 91.89,
        'defeatPrimaryReason': 'Closed',
        'defeatReasons': ['Closed', 'HigherPrice', 'HigherETA']},
       {'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e70072a05229',
        'optionId': '9047 || 9047 || LIQUIGAS',
        'isMobileDealer': False,
        'isOpen': False,
        'eta': '1:00',
        'chamaScore': 9.0,
        'productBrand': 'LIQUIGAS',
        'isWinner': False,
        'minimumPrice': 92.0,
        'maximumPrice': 184.0,
        'dynamicPrice': 93.9,
        'finalPrice': 93.9,
        'defeatPrimaryReason': 'Closed',
        'defeatReasons': ['Closed', 'HigherPrice', 'HigherETA']},
       {'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b352ec251f3',
        'optionId': '9047 || 9047 || NACIONALGAS',
        'isMobileDealer': False,
        'isOpen': False,
        'eta': '1:00',
        'chamaScore': 9.0,
        'productBrand': 'NACIONALGAS',
        'isWinner': True,
        'minimumPrice': 88.9,
        'maximumPrice': 177.8,
        'dynamicPrice': 90.8,
        'finalPrice': 90.8}]},
     {'curationProvider': 'ByPrice',
      'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
      'dealerId': '8330',
      'options': [{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-882037a9fd28',
        'optionId': '8330 || 8330 || CONSIGAZ',
        'isMobileDealer': False,
        'isOpen': True,
        'eta': '0:01',
        'chamaScore': 8.0,
        'productBrand': 'CONSIGAZ',
        'isWinner': True,
        'minimumPrice': 80.0,
        'maximumPrice': 160.0,
        'dynamicPrice': 87.35,
        'finalPrice': 87.35}]},
     {'curationProvider': 'ByPrice',
      'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
      'dealerId': '8835',
      'options': [{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3369c29db1d',
        'optionId': '8835 || 8835 || LIQUIGAS',
        'isMobileDealer': False,
        'isOpen': False,
        'eta': '0:01',
        'chamaScore': 8.0,
        'productBrand': 'LIQUIGAS',
        'isWinner': True,
        'minimumPrice': 60.0,
        'maximumPrice': 120.0,
        'dynamicPrice': 87.35,
        'finalPrice': 87.35}]}]
:::
:::

::: {.cell .code execution_count="892"}
``` python
payload=df_curate.Payload.apply(lambda x: json.loads(x)).explode()
# payload=pd.DataFrame(payload)
payload
```

::: {.output .execute_result execution_count="892"}
    3     {'curationProvider': 'ByPrice', 'offerId': '14...
    3     {'curationProvider': 'ByPrice', 'offerId': '14...
    3     {'curationProvider': 'ByPrice', 'offerId': '14...
    3     {'curationProvider': 'ByPrice', 'offerId': '14...
    13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
    13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
    13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
    13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
    15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
    15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
    15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
    15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
    17    {'curationProvider': 'ByPrice', 'offerId': '0a...
    17    {'curationProvider': 'ByPrice', 'offerId': '0a...
    17    {'curationProvider': 'ByPrice', 'offerId': '0a...
    17    {'curationProvider': 'ByPrice', 'offerId': '0a...
    35    {'curationProvider': 'ByPrice', 'offerId': '13...
    35    {'curationProvider': 'ByPrice', 'offerId': '13...
    35    {'curationProvider': 'ByPrice', 'offerId': '13...
    35    {'curationProvider': 'ByPrice', 'offerId': '13...
    Name: Payload, dtype: object
:::
:::

::: {.cell .code execution_count="893"}
``` python
payload = payload.apply(lambda x: pd.Series(x))
payload
```

::: {.output .execute_result execution_count="893"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>curationProvider</th>
      <th>offerId</th>
      <th>dealerId</th>
      <th>options</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="894"}
``` python
payload.options.iloc[4]
```

::: {.output .execute_result execution_count="894"}
    [{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
      'optionId': '6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2',
      'isMobileDealer': True,
      'isOpen': True,
      'eta': '00:12:54.9215999',
      'chamaScore': 8.0,
      'productBrand': 'ULTRAGAZ',
      'isWinner': True,
      'minimumPrice': 90.0,
      'maximumPrice': 180.0,
      'dynamicPrice': 91.9,
      'finalPrice': 91.9},
     {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
      'optionId': '6517 || 6517',
      'isMobileDealer': False,
      'isOpen': True,
      'eta': '0:01',
      'chamaScore': 8.0,
      'productBrand': 'ULTRAGAZ',
      'isWinner': False,
      'minimumPrice': 90.0,
      'maximumPrice': 180.0,
      'dynamicPrice': 91.9,
      'finalPrice': 91.9,
      'defeatPrimaryReason': 'HasDriverInOffer',
      'defeatReasons': ['HasDriverInOffer']}]
:::
:::

::: {.cell .code execution_count="895"}
``` python
df_curate = df_curate.merge(payload, left_index=True, right_index=True).drop('Payload', axis=1)
df_curate
```

::: {.output .execute_result execution_count="895"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>EventName</th>
      <th>curationProvider</th>
      <th>offerId</th>
      <th>dealerId</th>
      <th>options</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-2...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>[{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-3...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8330</td>
      <td>[{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-8...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8835</td>
      <td>[{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="896"}
``` python
df_curate = df_curate.explode('options')
df_curate
```

::: {.output .execute_result execution_count="896"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>EventName</th>
      <th>curationProvider</th>
      <th>offerId</th>
      <th>dealerId</th>
      <th>options</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e7...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>{'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8330</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8835</td>
      <td>{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e7...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>{'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8330</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8835</td>
      <td>{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e7...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>{'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8330</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8835</td>
      <td>{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e7...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>{'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8330</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8835</td>
      <td>{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-24...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>{'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '3cd346f4-d297-7568-2e50-d4...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>{'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e7...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>{'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8330</td>
      <td>{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-88...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>CurateOffer_Result</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8835</td>
      <td>{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3...</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="897"}
``` python
options = df_curate.options.apply(lambda x: pd.Series(x))
options.head(20)
```

::: {.output .execute_result execution_count="897"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uniqueOptionId</th>
      <th>optionId</th>
      <th>isMobileDealer</th>
      <th>isOpen</th>
      <th>eta</th>
      <th>chamaScore</th>
      <th>productBrand</th>
      <th>isWinner</th>
      <th>minimumPrice</th>
      <th>maximumPrice</th>
      <th>dynamicPrice</th>
      <th>finalPrice</th>
      <th>defeatPrimaryReason</th>
      <th>defeatReasons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>1:00</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>Closed</td>
      <td>[Closed, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>00:12:54.9215999</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>HasDriverInOffer</td>
      <td>[HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer, Higher...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>1:00</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>Closed</td>
      <td>[Closed, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="898"}
``` python
(df_curate.shape, options.shape)
```

::: {.output .execute_result execution_count="898"}
    ((40, 6), (40, 14))
:::
:::

::: {.cell .code execution_count="899"}
``` python
df_curate = pd.concat([df_curate, options], axis=1).drop(['options', 'EventName'], axis=1)
df_curate.reset_index(drop=True, inplace=True)
df_curate
```

::: {.output .execute_result execution_count="899"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EnqueuedTimeSP</th>
      <th>curationProvider</th>
      <th>offerId</th>
      <th>dealerId</th>
      <th>uniqueOptionId</th>
      <th>optionId</th>
      <th>isMobileDealer</th>
      <th>isOpen</th>
      <th>eta</th>
      <th>chamaScore</th>
      <th>productBrand</th>
      <th>isWinner</th>
      <th>minimumPrice</th>
      <th>maximumPrice</th>
      <th>dynamicPrice</th>
      <th>finalPrice</th>
      <th>defeatPrimaryReason</th>
      <th>defeatReasons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>1:00</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>6517</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>Closed</td>
      <td>[Closed, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>9047</td>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8330</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>149f0e53-ff85-425f-a01a-8710f06704ea</td>
      <td>8835</td>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>00:12:54.9215999</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>6517</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>HasDriverInOffer</td>
      <td>[HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer, Higher...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>9047</td>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8330</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d</td>
      <td>8835</td>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>1:00</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>6517</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>Closed</td>
      <td>[Closed, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>19</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>20</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>21</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>9047</td>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8330</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>d668106a-7596-49c6-b99a-18b7a2f3963f</td>
      <td>8835</td>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>00:01:27.4607999</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>6517</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>HasDriverInOffer</td>
      <td>[HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>26</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer, Higher...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>28</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>29</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>9047</td>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8330</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>0a06a478-77b3-4941-83d3-84ded18d4731</td>
      <td>8835</td>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>b0e296a9-0590-f0e0-8211-243a2ededb12</td>
      <td>6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2</td>
      <td>True</td>
      <td>True</td>
      <td>00:07:11.1911999</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>True</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>33</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>6517</td>
      <td>d6562c24-0b37-5fb4-8275-65b7b8b47b87</td>
      <td>6517 || 6517</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>90.00</td>
      <td>180.00</td>
      <td>91.90</td>
      <td>91.90</td>
      <td>HasDriverInOffer</td>
      <td>[HasDriverInOffer]</td>
    </tr>
    <tr>
      <th>34</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>8d0f9262-f543-d0c8-a869-33985ae3ecda</td>
      <td>9047 || 9047 || ULTRAGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>ULTRAGAZ</td>
      <td>False</td>
      <td>99.00</td>
      <td>198.00</td>
      <td>99.95</td>
      <td>99.95</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HasDriverInOffer, Higher...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>3cd346f4-d297-7568-2e50-d43a8e2fd0a9</td>
      <td>9047 || 9047 || CONSIGAZ</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>CONSIGAZ</td>
      <td>False</td>
      <td>89.99</td>
      <td>179.98</td>
      <td>91.89</td>
      <td>91.89</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>36</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>577e4bbd-f49d-ac23-56a6-e70072a05229</td>
      <td>9047 || 9047 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>LIQUIGAS</td>
      <td>False</td>
      <td>92.00</td>
      <td>184.00</td>
      <td>93.90</td>
      <td>93.90</td>
      <td>Closed</td>
      <td>[Closed, HigherPrice, HigherETA]</td>
    </tr>
    <tr>
      <th>37</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>9047</td>
      <td>f9b876ab-2590-952f-d69d-5b352ec251f3</td>
      <td>9047 || 9047 || NACIONALGAS</td>
      <td>False</td>
      <td>False</td>
      <td>1:00</td>
      <td>9.0</td>
      <td>NACIONALGAS</td>
      <td>True</td>
      <td>88.90</td>
      <td>177.80</td>
      <td>90.80</td>
      <td>90.80</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8330</td>
      <td>151e59ac-761a-96f5-d2b9-882037a9fd28</td>
      <td>8330 || 8330 || CONSIGAZ</td>
      <td>False</td>
      <td>True</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>CONSIGAZ</td>
      <td>True</td>
      <td>80.00</td>
      <td>160.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39</th>
      <td>25/08/2021</td>
      <td>ByPrice</td>
      <td>135d8401-11c0-4d21-bac1-cdb93ba65189</td>
      <td>8835</td>
      <td>b7a7b6d1-4dae-7392-5aaf-f3369c29db1d</td>
      <td>8835 || 8835 || LIQUIGAS</td>
      <td>False</td>
      <td>False</td>
      <td>0:01</td>
      <td>8.0</td>
      <td>LIQUIGAS</td>
      <td>True</td>
      <td>60.00</td>
      <td>120.00</td>
      <td>87.35</td>
      <td>87.35</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="900"}
``` python
# CurationProvider: in quotes
# OfferId: in quotes
# DealerId: in quotes
# UniqueOptionId: in quotes
# OptionId: in quotes
# IsMobileDealer: without quotes
# IsOpen: without quotes
# Eta: in quotes
# ChamaScore: without quotes
# ProductBrand: in quotes
# IsWinner: without quotes
# MinimumPrice: without quotes
# MaximumPrice: without quotes
# DynamicPrice: without quotes
# FinalPrice: without quotes
# DefeatPrimaryReason: in quotes
# DefeatReasons: in quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)
```
:::

::: {.cell .code execution_count="901"}
``` python
df_curate.columns
```

::: {.output .execute_result execution_count="901"}
    Index(['EnqueuedTimeSP', 'curationProvider', 'offerId', 'dealerId',
           'uniqueOptionId', 'optionId', 'isMobileDealer', 'isOpen', 'eta',
           'chamaScore', 'productBrand', 'isWinner', 'minimumPrice',
           'maximumPrice', 'dynamicPrice', 'finalPrice', 'defeatPrimaryReason',
           'defeatReasons'],
          dtype='object')
:::
:::

::: {.cell .code execution_count="902"}
``` python
[x.title() for x in df_curate.columns]
```

::: {.output .execute_result execution_count="902"}
    ['Enqueuedtimesp',
     'Curationprovider',
     'Offerid',
     'Dealerid',
     'Uniqueoptionid',
     'Optionid',
     'Ismobiledealer',
     'Isopen',
     'Eta',
     'Chamascore',
     'Productbrand',
     'Iswinner',
     'Minimumprice',
     'Maximumprice',
     'Dynamicprice',
     'Finalprice',
     'Defeatprimaryreason',
     'Defeatreasons']
:::
:::

::: {.cell .code execution_count="903"}
``` python
new_column_order = ['curationProvider', 'offerId', 'dealerId',
       'uniqueOptionId', 'optionId', 'isMobileDealer', 'isOpen', 'eta',
       'chamaScore', 'productBrand', 'isWinner', 'minimumPrice',
       'maximumPrice', 'dynamicPrice', 'finalPrice', 'defeatPrimaryReason',
       'defeatReasons', 'EnqueuedTimeSP']
df_curate = df_curate[new_column_order]
```
:::

::: {.cell .code execution_count="904"}
``` python
 = [x.capitalize() for x in df_curate.columns]
# dfdf_curate_colum
```

::: {.output .error ename="SyntaxError" evalue="invalid syntax (2078665106.py, line 1)"}
      Cell In[904], line 1
        = [x.capitalize() for x in df_curate.columns]
        ^
    SyntaxError: invalid syntax
:::
:::

::: {.cell .code}
``` python
df_curate.columns
```
:::

::: {.cell .code execution_count="804"}
``` python
new_column_order = ['Curationprovider', 'Offerid', 'Dealerid', 'Uniqueoptionid', 'Optionid',
 'Ismobiledealer',  'Isopen', 'Eta', 'Chamascore', 'Productbrand',
 'Iswinner', 'Minimumprice', 'Maximumprice', 'Dynamicprice', 'Finalprice',
 'Defeatprimaryreason', 'Defeatreasons', 'Enqueuedtimesp']
df_curate = df_curate[new_column_order]
```
:::

::: {.cell .code}
``` python
df_curate.fillna('""')
```
:::

::: {.cell .code}
``` python
```
:::

::: {.cell .code execution_count="806"}
``` python
# save dataframes to csv
df_dynamic_option.to_csv('DynamicPriceOption.csv', index=False)
df_dynamic_range.to_csv('DynamicPriceRange.csv', index=False)
df_curate.to_csv('CuratedOfferOptions.csv', index=False)
```
:::

```
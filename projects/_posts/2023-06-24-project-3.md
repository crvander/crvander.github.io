---
layout: post
title: Project 3
image: 
  path: /assets/img/blog/jeremy-bishop@0,5x.jpg
# description: >
#   Version 9 is the most complete version of Hydejack yet.
#   Modernized design, big headlines, and big new features.
sitemap: true
---

<!-- Version 9 is the most complete version of Hydejack yet.
{:.lead}

[Modernized](#linking-in-style) [design](#whats-in-the-cards), [big headlines](#ready-for-the-big-screen), big new features: [Built-In Search](#built-in-search), [Sticky Table of Contents](#sticky-table-of-contents), and [Auto-Hiding Navbar](#auto-hiding-navbar). That [and more](#and-much-more) is Hydejack 9.

- Table of Contents
{:toc .large-only} -->

### Hi there

This is a test article.





case2

















In \[858]:



```
import pandas as pd
import numpy as np
import json

```










In \[859]:



```
# CuratedOfferOptions.csv:
# CurationProvider: in quotes
# OfferId: in quotes
# DealerId: in quotes
# UniqueOptionId: in quotes
# OptionId: in quotes
# IsMobileDealer: without quotes
# IsOpen: without quotes
# Eta: in quotes
# ChamaScore: without quotes
# ProductBrand: in quotes
# IsWinner: without quotes
# MinimumPrice: without quotes
# MaximumPrice: without quotes
# DynamicPrice: without quotes
# FinalPrice: without quotes
# DefeatPrimaryReason: in quotes
# DefeatReasons: in quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

# DynamicPriceOption.csv:
# Provider: in quotes
# OfferId: in quotes
# UniqueOptionId: in quotes
# BestPrice: without quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

# DynamicPriceRange.csv:
# Provider: in quotes
# OfferId: in quotes
# MinGlobal: without quotes
# MinRecommended: without quotes
# MaxRecommended: without quotes
# DifferenceMinRecommendMinTheory: without quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

```










In \[860]:



```
df=pd.read_json('case.json')
df.head()

```










Out\[860]:





|  | EnqueuedTimeUtc | EventName | Payload |
| --- | --- | --- | --- |
| 0 | 2021\-09\-05 08:04:08 UTC | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 1 | 2021\-08\-18 11:43:23 UTC | DynamicPrice\_Result | {"provider":"ApplyDynamicPricePerOption","offe... |
| 2 | 2021\-09\-05 09:04:04 UTC | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 3 | 2021\-08\-25 05:02:55 UTC | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"149f... |
| 4 | 2021\-09\-05 08:03:28 UTC | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |












In \[861]:



```
df['EnqueuedTimeUtc'] = pd.to_datetime(df['EnqueuedTimeUtc']).dt.tz_convert('America/Sao_Paulo')
df['EnqueuedTimeUtc'] = df['EnqueuedTimeUtc'].dt.strftime('%d/%m/%Y')
df.rename(columns={'EnqueuedTimeUtc': 'EnqueuedTimeSP'}, inplace=True)
df.head()

```










Out\[861]:





|  | EnqueuedTimeSP | EventName | Payload |
| --- | --- | --- | --- |
| 0 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 1 | 18/08/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPricePerOption","offe... |
| 2 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 3 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"149f... |
| 4 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |












In \[862]:



```
# DYNAMIC DF
df_dynamic = df[df['EventName'] == 'DynamicPrice_Result']

# CURATE DF
df_curate = df[df['EventName'] == 'CurateOffer_Result']

```










In \[863]:



```
df_dynamic.head()

```










Out\[863]:





|  | EnqueuedTimeSP | EventName | Payload |
| --- | --- | --- | --- |
| 0 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 1 | 18/08/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPricePerOption","offe... |
| 2 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 4 | 05/09/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPriceRange","offerId"... |
| 5 | 18/08/2021 | DynamicPrice\_Result | {"provider":"ApplyDynamicPricePerOption","offe... |












In \[864]:



```
json.loads(df_dynamic.Payload.iloc[0])

```










Out\[864]:


```
{'provider': 'ApplyDynamicPriceRange',
 'offerId': 'a6611d55-9624-4381-8cdd-323ee3689241',
 'algorithmOutput': {'min_global': 85.0,
  'min_recommended': 87.2,
  'max_recommended': 97.65,
  'differenceMinRecommendMinTheory': 2.2}}
```










In \[865]:



```
# a=pd.json_normalize(df_dynamic.Payload.apply(lambda x: json.loads(x)))
# a.head()

```










In \[866]:



```
payload = df_dynamic['Payload'].apply(lambda x: pd.Series(json.loads(x)))
payload.head()

```










Out\[866]:





|  | provider | offerId | algorithmOutput |
| --- | --- | --- | --- |
| 0 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 1 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 2 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 4 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 5 | ApplyDynamicPricePerOption | 00991873\-194e\-4a6e\-89c9\-8f68668b6aaa | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |












In \[867]:



```
(df_dynamic.shape, payload.shape)

```










Out\[867]:


```
((32, 3), (32, 3))
```










In \[868]:



```
df_dynamic = pd.concat([df_dynamic, payload], axis=1).drop(['Payload', 'EventName'], axis=1)
df_dynamic.head()

```










Out\[868]:





|  | EnqueuedTimeSP | provider | offerId | algorithmOutput |
| --- | --- | --- | --- | --- |
| 0 | 05/09/2021 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 2 | 05/09/2021 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 4 | 05/09/2021 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 5 | 18/08/2021 | ApplyDynamicPricePerOption | 00991873\-194e\-4a6e\-89c9\-8f68668b6aaa | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |












In \[869]:



```
# DynamicPriceOption
df_dynamic_option = df_dynamic[df_dynamic['provider'] == 'ApplyDynamicPricePerOption']

# DynamicPriceRange
df_dynamic_range = df_dynamic[df_dynamic['provider'] == 'ApplyDynamicPriceRange']

```










In \[870]:



```
df_dynamic_option.head()

```










Out\[870]:





|  | EnqueuedTimeSP | provider | offerId | algorithmOutput |
| --- | --- | --- | --- | --- |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 5 | 18/08/2021 | ApplyDynamicPricePerOption | 00991873\-194e\-4a6e\-89c9\-8f68668b6aaa | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 8 | 18/08/2021 | ApplyDynamicPricePerOption | 00991873\-194e\-4a6e\-89c9\-8f68668b6aaa | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 12 | 18/08/2021 | ApplyDynamicPricePerOption | 7a471a13\-7922\-4e7a\-9667\-9b2f96b44a2a | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 20 | 18/08/2021 | ApplyDynamicPricePerOption | 7cb20a39\-c7f9\-4c4c\-9d51\-94dbb8c4ff07 | \[{'uniqueOptionId': '9c4ec643\-934f\-56d1\-198d\-4\... |












In \[871]:



```
df_dynamic_option.algorithmOutput.iloc[0]

```










Out\[871]:


```
[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
  'bestPrice': 92.45},
 {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
  'bestPrice': 92.45},
 {'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33985ae3ecda',
  'bestPrice': 92.45},
 {'uniqueOptionId': '151e59ac-761a-96f5-d2b9-882037a9fd28', 'bestPrice': 94.6},
 {'uniqueOptionId': '3cd346f4-d297-7568-2e50-d43a8e2fd0a9', 'bestPrice': 94.6},
 {'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3369c29db1d', 'bestPrice': 93.0},
 {'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e70072a05229', 'bestPrice': 93.0},
 {'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b352ec251f3',
  'bestPrice': 91.35}]
```










In \[872]:



```
df_dynamic_option = df_dynamic_option.explode('algorithmOutput')
df_dynamic_option.head()

```










Out\[872]:





|  | EnqueuedTimeSP | provider | offerId | algorithmOutput |
| --- | --- | --- | --- | --- |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |












In \[873]:



```
# pd.json_normalize(df_dynamic_option.algorithmOutput).shape

```










In \[874]:



```
# df_dynamic_option_alg = df_dynamic_option['algorithmOutput'].apply(lambda x: pd.Series(x))
# df_dynamic_option_alg.head()

```










In \[875]:



```
# df_dynamic_option = pd.merge(df_dynamic_option, df_dynamic_option_alg, left_index=True, right_index=True).drop('algorithmOutput', axis=1)
# df_dynamic_option

```










In \[876]:



```
df_dynamic_option_alg = pd.json_normalize(df_dynamic_option.algorithmOutput)
df_dynamic_option_alg.head()

```










Out\[876]:





|  | uniqueOptionId | bestPrice |
| --- | --- | --- |
| 0 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 92\.45 |
| 1 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 92\.45 |
| 2 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 92\.45 |
| 3 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 94\.60 |
| 4 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 94\.60 |












In \[877]:



```
df_dynamic_option.reset_index(drop=True, inplace=True)
df_dynamic_option = pd.concat([df_dynamic_option, df_dynamic_option_alg], axis=1).drop('algorithmOutput', axis=1)
df_dynamic_option.head()

```










Out\[877]:





|  | EnqueuedTimeSP | provider | offerId | uniqueOptionId | bestPrice |
| --- | --- | --- | --- | --- | --- |
| 0 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 92\.45 |
| 1 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 92\.45 |
| 2 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 92\.45 |
| 3 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 94\.60 |
| 4 | 18/08/2021 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 94\.60 |












In \[878]:



```
df_dynamic_option.columns

```










Out\[878]:


```
Index(['EnqueuedTimeSP', 'provider', 'offerId', 'uniqueOptionId', 'bestPrice'], dtype='object')
```










In \[879]:



```
new_column_order = ['provider', 'offerId', 'uniqueOptionId', 'bestPrice', 'EnqueuedTimeSP']
df_dynamic_option = df_dynamic_option[new_column_order]
df_dynamic_option.head()

```










Out\[879]:





|  | provider | offerId | uniqueOptionId | bestPrice | EnqueuedTimeSP |
| --- | --- | --- | --- | --- | --- |
| 0 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 92\.45 | 18/08/2021 |
| 1 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 92\.45 | 18/08/2021 |
| 2 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 92\.45 | 18/08/2021 |
| 3 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 94\.60 | 18/08/2021 |
| 4 | ApplyDynamicPricePerOption | 56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 94\.60 | 18/08/2021 |












In \[880]:



```
# final df_dinamic_option df
# Provider: in quotes
# OfferId: in quotes
# UniqueOptionId: in quotes
# BestPrice: without quotes
# EnqueuedTimeSP: DD/MM/YYYY
# df_dynamic_option.drop('EventName', axis=1, inplace=True)
# df_dynamic_range.provider.apply(lambda x: "\""+x+"\"")
# df_dynamic_option.head()

```










In \[881]:



```
for idx, val in enumerate(df_dynamic_option.columns):
    if idx == 4:
        break
    df_dynamic_option[val]=df_dynamic_option[val].apply(lambda x: '\"'+str(x)+'\"')

df_dynamic_option.head()

```










Out\[881]:





|  | provider | offerId | uniqueOptionId | bestPrice | EnqueuedTimeSP |
| --- | --- | --- | --- | --- | --- |
| 0 | "ApplyDynamicPricePerOption" | "56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b" | "b0e296a9\-0590\-f0e0\-8211\-243a2ededb12" | "92\.45" | 18/08/2021 |
| 1 | "ApplyDynamicPricePerOption" | "56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b" | "d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87" | "92\.45" | 18/08/2021 |
| 2 | "ApplyDynamicPricePerOption" | "56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b" | "8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda" | "92\.45" | 18/08/2021 |
| 3 | "ApplyDynamicPricePerOption" | "56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b" | "151e59ac\-761a\-96f5\-d2b9\-882037a9fd28" | "94\.6" | 18/08/2021 |
| 4 | "ApplyDynamicPricePerOption" | "56e0702c\-0218\-4626\-8d3d\-ae9d54b4503b" | "3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9" | "94\.6" | 18/08/2021 |












In \[882]:



```
df_dynamic_range.head()

```










Out\[882]:





|  | EnqueuedTimeSP | provider | offerId | algorithmOutput |
| --- | --- | --- | --- | --- |
| 0 | 05/09/2021 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 2 | 05/09/2021 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 4 | 05/09/2021 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 6 | 05/09/2021 | ApplyDynamicPriceRange | 329194f3\-95a4\-45ef\-b3d0\-2796f74ce2a0 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 7 | 05/09/2021 | ApplyDynamicPriceRange | fdcfde5c\-113d\-4a59\-9ae0\-8bc31e2943d8 | {'min\_global': 87\.35, 'min\_recommended': 89\.25\... |












In \[883]:



```
df_dynamic_range['algorithmOutput'].iloc[0]

```










Out\[883]:


```
{'min_global': 85.0,
 'min_recommended': 87.2,
 'max_recommended': 97.65,
 'differenceMinRecommendMinTheory': 2.2}
```










In \[884]:



```
df_dynamic_range.reset_index(inplace=True, drop=True)
df_dynamic_range.head()

```










Out\[884]:





|  | EnqueuedTimeSP | provider | offerId | algorithmOutput |
| --- | --- | --- | --- | --- |
| 0 | 05/09/2021 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 1 | 05/09/2021 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 2 | 05/09/2021 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 3 | 05/09/2021 | ApplyDynamicPriceRange | 329194f3\-95a4\-45ef\-b3d0\-2796f74ce2a0 | {'min\_global': 85\.0, 'min\_recommended': 87\.2, ... |
| 4 | 05/09/2021 | ApplyDynamicPriceRange | fdcfde5c\-113d\-4a59\-9ae0\-8bc31e2943d8 | {'min\_global': 87\.35, 'min\_recommended': 89\.25\... |












In \[885]:



```
df_dynamic_range_alg = pd.json_normalize(df_dynamic_range['algorithmOutput'])
df_dynamic_range_alg.head()

```










Out\[885]:





|  | min\_global | min\_recommended | max\_recommended | differenceMinRecommendMinTheory |
| --- | --- | --- | --- | --- |
| 0 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 1 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 2 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 3 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 4 | 87\.35 | 89\.25 | 99\.95 | 1\.9 |












In \[886]:



```
df_dynamic_range = pd.concat([df_dynamic_range, df_dynamic_range_alg], axis=1).drop('algorithmOutput', axis=1)
df_dynamic_range.head()

```










Out\[886]:





|  | EnqueuedTimeSP | provider | offerId | min\_global | min\_recommended | max\_recommended | differenceMinRecommendMinTheory |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 05/09/2021 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 1 | 05/09/2021 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 2 | 05/09/2021 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 3 | 05/09/2021 | ApplyDynamicPriceRange | 329194f3\-95a4\-45ef\-b3d0\-2796f74ce2a0 | 85\.00 | 87\.20 | 97\.65 | 2\.2 |
| 4 | 05/09/2021 | ApplyDynamicPriceRange | fdcfde5c\-113d\-4a59\-9ae0\-8bc31e2943d8 | 87\.35 | 89\.25 | 99\.95 | 1\.9 |












In \[887]:



```
df_dynamic_range.columns

```










Out\[887]:


```
Index(['EnqueuedTimeSP', 'provider', 'offerId', 'min_global',
       'min_recommended', 'max_recommended',
       'differenceMinRecommendMinTheory'],
      dtype='object')
```










In \[888]:



```
new_column_order = ['provider', 'offerId', 'min_global',
       'min_recommended', 'max_recommended',
       'differenceMinRecommendMinTheory', 'EnqueuedTimeSP']
df_dynamic_range = df_dynamic_range[new_column_order]
df_dynamic_range.head()

```










Out\[888]:





|  | provider | offerId | min\_global | min\_recommended | max\_recommended | differenceMinRecommendMinTheory | EnqueuedTimeSP |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | ApplyDynamicPriceRange | a6611d55\-9624\-4381\-8cdd\-323ee3689241 | 85\.00 | 87\.20 | 97\.65 | 2\.2 | 05/09/2021 |
| 1 | ApplyDynamicPriceRange | b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c | 85\.00 | 87\.20 | 97\.65 | 2\.2 | 05/09/2021 |
| 2 | ApplyDynamicPriceRange | 3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7 | 85\.00 | 87\.20 | 97\.65 | 2\.2 | 05/09/2021 |
| 3 | ApplyDynamicPriceRange | 329194f3\-95a4\-45ef\-b3d0\-2796f74ce2a0 | 85\.00 | 87\.20 | 97\.65 | 2\.2 | 05/09/2021 |
| 4 | ApplyDynamicPriceRange | fdcfde5c\-113d\-4a59\-9ae0\-8bc31e2943d8 | 87\.35 | 89\.25 | 99\.95 | 1\.9 | 05/09/2021 |












In \[889]:



```
for idx, val in enumerate(df_dynamic_range):
    if idx == 6:
        break
    df_dynamic_range[val] = df_dynamic_range[val].apply(lambda x: '\"'+str(x)+'\"')

df_dynamic_range.head()

```










Out\[889]:





|  | provider | offerId | min\_global | min\_recommended | max\_recommended | differenceMinRecommendMinTheory | EnqueuedTimeSP |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | "ApplyDynamicPriceRange" | "a6611d55\-9624\-4381\-8cdd\-323ee3689241" | "85\.0" | "87\.2" | "97\.65" | "2\.2" | 05/09/2021 |
| 1 | "ApplyDynamicPriceRange" | "b8c636fa\-8241\-47dc\-ac40\-bdf438a04d9c" | "85\.0" | "87\.2" | "97\.65" | "2\.2" | 05/09/2021 |
| 2 | "ApplyDynamicPriceRange" | "3d32f7fb\-396d\-4d3f\-b673\-dea1f7dc41b7" | "85\.0" | "87\.2" | "97\.65" | "2\.2" | 05/09/2021 |
| 3 | "ApplyDynamicPriceRange" | "329194f3\-95a4\-45ef\-b3d0\-2796f74ce2a0" | "85\.0" | "87\.2" | "97\.65" | "2\.2" | 05/09/2021 |
| 4 | "ApplyDynamicPriceRange" | "fdcfde5c\-113d\-4a59\-9ae0\-8bc31e2943d8" | "87\.35" | "89\.25" | "99\.95" | "1\.9" | 05/09/2021 |












In \[890]:



```
df_curate.head()

```










Out\[890]:





|  | EnqueuedTimeSP | EventName | Payload |
| --- | --- | --- | --- |
| 3 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"149f... |
| 13 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"c99a... |
| 15 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"d668\... |
| 17 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"0a06\... |
| 35 | 25/08/2021 | CurateOffer\_Result | \[{"curationProvider":"ByPrice","offerId":"135d... |












In \[891]:



```
json.loads(df_curate.Payload.iloc[1])

```










Out\[891]:


```
[{'curationProvider': 'ByPrice',
  'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
  'dealerId': '6517',
  'options': [{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
    'optionId': '6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2',
    'isMobileDealer': True,
    'isOpen': True,
    'eta': '00:12:54.9215999',
    'chamaScore': 8.0,
    'productBrand': 'ULTRAGAZ',
    'isWinner': True,
    'minimumPrice': 90.0,
    'maximumPrice': 180.0,
    'dynamicPrice': 91.9,
    'finalPrice': 91.9},
   {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
    'optionId': '6517 || 6517',
    'isMobileDealer': False,
    'isOpen': True,
    'eta': '0:01',
    'chamaScore': 8.0,
    'productBrand': 'ULTRAGAZ',
    'isWinner': False,
    'minimumPrice': 90.0,
    'maximumPrice': 180.0,
    'dynamicPrice': 91.9,
    'finalPrice': 91.9,
    'defeatPrimaryReason': 'HasDriverInOffer',
    'defeatReasons': ['HasDriverInOffer']}]},
 {'curationProvider': 'ByPrice',
  'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
  'dealerId': '9047',
  'options': [{'uniqueOptionId': '8d0f9262-f543-d0c8-a869-33985ae3ecda',
    'optionId': '9047 || 9047 || ULTRAGAZ',
    'isMobileDealer': False,
    'isOpen': False,
    'eta': '1:00',
    'chamaScore': 9.0,
    'productBrand': 'ULTRAGAZ',
    'isWinner': False,
    'minimumPrice': 99.0,
    'maximumPrice': 198.0,
    'dynamicPrice': 99.95,
    'finalPrice': 99.95,
    'defeatPrimaryReason': 'Closed',
    'defeatReasons': ['Closed',
     'HigherPrice',
     'HasDriverInOffer',
     'HigherETA']},
   {'uniqueOptionId': '3cd346f4-d297-7568-2e50-d43a8e2fd0a9',
    'optionId': '9047 || 9047 || CONSIGAZ',
    'isMobileDealer': False,
    'isOpen': False,
    'eta': '1:00',
    'chamaScore': 9.0,
    'productBrand': 'CONSIGAZ',
    'isWinner': False,
    'minimumPrice': 89.99,
    'maximumPrice': 179.98,
    'dynamicPrice': 91.89,
    'finalPrice': 91.89,
    'defeatPrimaryReason': 'Closed',
    'defeatReasons': ['Closed', 'HigherPrice', 'HigherETA']},
   {'uniqueOptionId': '577e4bbd-f49d-ac23-56a6-e70072a05229',
    'optionId': '9047 || 9047 || LIQUIGAS',
    'isMobileDealer': False,
    'isOpen': False,
    'eta': '1:00',
    'chamaScore': 9.0,
    'productBrand': 'LIQUIGAS',
    'isWinner': False,
    'minimumPrice': 92.0,
    'maximumPrice': 184.0,
    'dynamicPrice': 93.9,
    'finalPrice': 93.9,
    'defeatPrimaryReason': 'Closed',
    'defeatReasons': ['Closed', 'HigherPrice', 'HigherETA']},
   {'uniqueOptionId': 'f9b876ab-2590-952f-d69d-5b352ec251f3',
    'optionId': '9047 || 9047 || NACIONALGAS',
    'isMobileDealer': False,
    'isOpen': False,
    'eta': '1:00',
    'chamaScore': 9.0,
    'productBrand': 'NACIONALGAS',
    'isWinner': True,
    'minimumPrice': 88.9,
    'maximumPrice': 177.8,
    'dynamicPrice': 90.8,
    'finalPrice': 90.8}]},
 {'curationProvider': 'ByPrice',
  'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
  'dealerId': '8330',
  'options': [{'uniqueOptionId': '151e59ac-761a-96f5-d2b9-882037a9fd28',
    'optionId': '8330 || 8330 || CONSIGAZ',
    'isMobileDealer': False,
    'isOpen': True,
    'eta': '0:01',
    'chamaScore': 8.0,
    'productBrand': 'CONSIGAZ',
    'isWinner': True,
    'minimumPrice': 80.0,
    'maximumPrice': 160.0,
    'dynamicPrice': 87.35,
    'finalPrice': 87.35}]},
 {'curationProvider': 'ByPrice',
  'offerId': 'c99aa9a7-ac50-4a10-be0f-ac9f5ac0f45d',
  'dealerId': '8835',
  'options': [{'uniqueOptionId': 'b7a7b6d1-4dae-7392-5aaf-f3369c29db1d',
    'optionId': '8835 || 8835 || LIQUIGAS',
    'isMobileDealer': False,
    'isOpen': False,
    'eta': '0:01',
    'chamaScore': 8.0,
    'productBrand': 'LIQUIGAS',
    'isWinner': True,
    'minimumPrice': 60.0,
    'maximumPrice': 120.0,
    'dynamicPrice': 87.35,
    'finalPrice': 87.35}]}]
```










In \[892]:



```
payload=df_curate.Payload.apply(lambda x: json.loads(x)).explode()
# payload=pd.DataFrame(payload)
payload

```










Out\[892]:


```
3     {'curationProvider': 'ByPrice', 'offerId': '14...
3     {'curationProvider': 'ByPrice', 'offerId': '14...
3     {'curationProvider': 'ByPrice', 'offerId': '14...
3     {'curationProvider': 'ByPrice', 'offerId': '14...
13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
13    {'curationProvider': 'ByPrice', 'offerId': 'c9...
15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
15    {'curationProvider': 'ByPrice', 'offerId': 'd6...
17    {'curationProvider': 'ByPrice', 'offerId': '0a...
17    {'curationProvider': 'ByPrice', 'offerId': '0a...
17    {'curationProvider': 'ByPrice', 'offerId': '0a...
17    {'curationProvider': 'ByPrice', 'offerId': '0a...
35    {'curationProvider': 'ByPrice', 'offerId': '13...
35    {'curationProvider': 'ByPrice', 'offerId': '13...
35    {'curationProvider': 'ByPrice', 'offerId': '13...
35    {'curationProvider': 'ByPrice', 'offerId': '13...
Name: Payload, dtype: object
```










In \[893]:



```
payload = payload.apply(lambda x: pd.Series(x))
payload

```










Out\[893]:





|  | curationProvider | offerId | dealerId | options |
| --- | --- | --- | --- | --- |
| 3 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 3 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 3 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 3 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 13 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 13 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 13 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 13 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 15 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 15 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 15 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 15 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 17 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 17 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 17 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 17 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 35 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 35 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 35 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 35 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |












In \[894]:



```
payload.options.iloc[4]

```










Out\[894]:


```
[{'uniqueOptionId': 'b0e296a9-0590-f0e0-8211-243a2ededb12',
  'optionId': '6517 || dd839e4c-9f84-45eb-9cb2-9069fecf70f2',
  'isMobileDealer': True,
  'isOpen': True,
  'eta': '00:12:54.9215999',
  'chamaScore': 8.0,
  'productBrand': 'ULTRAGAZ',
  'isWinner': True,
  'minimumPrice': 90.0,
  'maximumPrice': 180.0,
  'dynamicPrice': 91.9,
  'finalPrice': 91.9},
 {'uniqueOptionId': 'd6562c24-0b37-5fb4-8275-65b7b8b47b87',
  'optionId': '6517 || 6517',
  'isMobileDealer': False,
  'isOpen': True,
  'eta': '0:01',
  'chamaScore': 8.0,
  'productBrand': 'ULTRAGAZ',
  'isWinner': False,
  'minimumPrice': 90.0,
  'maximumPrice': 180.0,
  'dynamicPrice': 91.9,
  'finalPrice': 91.9,
  'defeatPrimaryReason': 'HasDriverInOffer',
  'defeatReasons': ['HasDriverInOffer']}]
```










In \[895]:



```
df_curate = df_curate.merge(payload, left_index=True, right_index=True).drop('Payload', axis=1)
df_curate

```










Out\[895]:





|  | EnqueuedTimeSP | EventName | curationProvider | offerId | dealerId | options |
| --- | --- | --- | --- | --- | --- | --- |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | \[{'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-2\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | \[{'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-3\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8330 | \[{'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-8\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8835 | \[{'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f... |












In \[896]:



```
df_curate = df_curate.explode('options')
df_curate

```










Out\[896]:





|  | EnqueuedTimeSP | EventName | curationProvider | offerId | dealerId | options |
| --- | --- | --- | --- | --- | --- | --- |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | {'uniqueOptionId': '577e4bbd\-f49d\-ac23\-56a6\-e7\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | {'uniqueOptionId': 'f9b876ab\-2590\-952f\-d69d\-5b... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8330 | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 3 | 25/08/2021 | CurateOffer\_Result | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8835 | {'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f3\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | {'uniqueOptionId': '577e4bbd\-f49d\-ac23\-56a6\-e7\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | {'uniqueOptionId': 'f9b876ab\-2590\-952f\-d69d\-5b... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8330 | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 13 | 25/08/2021 | CurateOffer\_Result | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8835 | {'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f3\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | {'uniqueOptionId': '577e4bbd\-f49d\-ac23\-56a6\-e7\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | {'uniqueOptionId': 'f9b876ab\-2590\-952f\-d69d\-5b... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8330 | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 15 | 25/08/2021 | CurateOffer\_Result | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8835 | {'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f3\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | {'uniqueOptionId': '577e4bbd\-f49d\-ac23\-56a6\-e7\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | {'uniqueOptionId': 'f9b876ab\-2590\-952f\-d69d\-5b... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8330 | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 17 | 25/08/2021 | CurateOffer\_Result | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8835 | {'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f3\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | {'uniqueOptionId': 'b0e296a9\-0590\-f0e0\-8211\-24\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | {'uniqueOptionId': 'd6562c24\-0b37\-5fb4\-8275\-65\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | {'uniqueOptionId': '8d0f9262\-f543\-d0c8\-a869\-33\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | {'uniqueOptionId': '3cd346f4\-d297\-7568\-2e50\-d4\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | {'uniqueOptionId': '577e4bbd\-f49d\-ac23\-56a6\-e7\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | {'uniqueOptionId': 'f9b876ab\-2590\-952f\-d69d\-5b... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8330 | {'uniqueOptionId': '151e59ac\-761a\-96f5\-d2b9\-88\... |
| 35 | 25/08/2021 | CurateOffer\_Result | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8835 | {'uniqueOptionId': 'b7a7b6d1\-4dae\-7392\-5aaf\-f3\... |












In \[897]:



```
options = df_curate.options.apply(lambda x: pd.Series(x))
options.head(20)

```










Out\[897]:





|  | uniqueOptionId | optionId | isMobileDealer | isOpen | eta | chamaScore | productBrand | isWinner | minimumPrice | maximumPrice | dynamicPrice | finalPrice | defeatPrimaryReason | defeatReasons |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 3 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 1:00 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 3 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | False | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | Closed | \[Closed, HasDriverInOffer] |
| 3 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer] |
| 3 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 3 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 3 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 3 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 3 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 13 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 00:12:54\.9215999 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 13 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | True | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | HasDriverInOffer | \[HasDriverInOffer] |
| 13 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer, Higher... |
| 13 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 13 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 13 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 13 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 13 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 15 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 1:00 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 15 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | False | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | Closed | \[Closed, HasDriverInOffer] |
| 15 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer] |
| 15 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |












In \[898]:



```
(df_curate.shape, options.shape)

```










Out\[898]:


```
((40, 6), (40, 14))
```










In \[899]:



```
df_curate = pd.concat([df_curate, options], axis=1).drop(['options', 'EventName'], axis=1)
df_curate.reset_index(drop=True, inplace=True)
df_curate

```










Out\[899]:





|  | EnqueuedTimeSP | curationProvider | offerId | dealerId | uniqueOptionId | optionId | isMobileDealer | isOpen | eta | chamaScore | productBrand | isWinner | minimumPrice | maximumPrice | dynamicPrice | finalPrice | defeatPrimaryReason | defeatReasons |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 1:00 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 1 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 6517 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | False | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | Closed | \[Closed, HasDriverInOffer] |
| 2 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer] |
| 3 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 4 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 5 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 9047 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 6 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8330 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 7 | 25/08/2021 | ByPrice | 149f0e53\-ff85\-425f\-a01a\-8710f06704ea | 8835 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 8 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 00:12:54\.9215999 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 9 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 6517 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | True | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | HasDriverInOffer | \[HasDriverInOffer] |
| 10 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer, Higher... |
| 11 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 12 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 13 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 9047 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 14 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8330 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 15 | 25/08/2021 | ByPrice | c99aa9a7\-ac50\-4a10\-be0f\-ac9f5ac0f45d | 8835 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 16 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 1:00 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 17 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 6517 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | False | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | Closed | \[Closed, HasDriverInOffer] |
| 18 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer] |
| 19 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 20 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 21 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 9047 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 22 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8330 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 23 | 25/08/2021 | ByPrice | d668106a\-7596\-49c6\-b99a\-18b7a2f3963f | 8835 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 24 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 00:01:27\.4607999 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 25 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 6517 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | True | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | HasDriverInOffer | \[HasDriverInOffer] |
| 26 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer, Higher... |
| 27 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 28 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 29 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 9047 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 30 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8330 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 31 | 25/08/2021 | ByPrice | 0a06a478\-77b3\-4941\-83d3\-84ded18d4731 | 8835 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 32 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | b0e296a9\-0590\-f0e0\-8211\-243a2ededb12 | 6517 \|\| dd839e4c\-9f84\-45eb\-9cb2\-9069fecf70f2 | True | True | 00:07:11\.1911999 | 8\.0 | ULTRAGAZ | True | 90\.00 | 180\.00 | 91\.90 | 91\.90 | NaN | NaN |
| 33 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 6517 | d6562c24\-0b37\-5fb4\-8275\-65b7b8b47b87 | 6517 \|\| 6517 | False | True | 0:01 | 8\.0 | ULTRAGAZ | False | 90\.00 | 180\.00 | 91\.90 | 91\.90 | HasDriverInOffer | \[HasDriverInOffer] |
| 34 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | 8d0f9262\-f543\-d0c8\-a869\-33985ae3ecda | 9047 \|\| 9047 \|\| ULTRAGAZ | False | False | 1:00 | 9\.0 | ULTRAGAZ | False | 99\.00 | 198\.00 | 99\.95 | 99\.95 | Closed | \[Closed, HigherPrice, HasDriverInOffer, Higher... |
| 35 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | 3cd346f4\-d297\-7568\-2e50\-d43a8e2fd0a9 | 9047 \|\| 9047 \|\| CONSIGAZ | False | False | 1:00 | 9\.0 | CONSIGAZ | False | 89\.99 | 179\.98 | 91\.89 | 91\.89 | Closed | \[Closed, HigherPrice, HigherETA] |
| 36 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | 577e4bbd\-f49d\-ac23\-56a6\-e70072a05229 | 9047 \|\| 9047 \|\| LIQUIGAS | False | False | 1:00 | 9\.0 | LIQUIGAS | False | 92\.00 | 184\.00 | 93\.90 | 93\.90 | Closed | \[Closed, HigherPrice, HigherETA] |
| 37 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 9047 | f9b876ab\-2590\-952f\-d69d\-5b352ec251f3 | 9047 \|\| 9047 \|\| NACIONALGAS | False | False | 1:00 | 9\.0 | NACIONALGAS | True | 88\.90 | 177\.80 | 90\.80 | 90\.80 | NaN | NaN |
| 38 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8330 | 151e59ac\-761a\-96f5\-d2b9\-882037a9fd28 | 8330 \|\| 8330 \|\| CONSIGAZ | False | True | 0:01 | 8\.0 | CONSIGAZ | True | 80\.00 | 160\.00 | 87\.35 | 87\.35 | NaN | NaN |
| 39 | 25/08/2021 | ByPrice | 135d8401\-11c0\-4d21\-bac1\-cdb93ba65189 | 8835 | b7a7b6d1\-4dae\-7392\-5aaf\-f3369c29db1d | 8835 \|\| 8835 \|\| LIQUIGAS | False | False | 0:01 | 8\.0 | LIQUIGAS | True | 60\.00 | 120\.00 | 87\.35 | 87\.35 | NaN | NaN |












In \[900]:



```
# CurationProvider: in quotes
# OfferId: in quotes
# DealerId: in quotes
# UniqueOptionId: in quotes
# OptionId: in quotes
# IsMobileDealer: without quotes
# IsOpen: without quotes
# Eta: in quotes
# ChamaScore: without quotes
# ProductBrand: in quotes
# IsWinner: without quotes
# MinimumPrice: without quotes
# MaximumPrice: without quotes
# DynamicPrice: without quotes
# FinalPrice: without quotes
# DefeatPrimaryReason: in quotes
# DefeatReasons: in quotes
# EnqueuedTimeSP: DD/MM/YYYY (converted to Brasilian timezone - UTC-3)

```










In \[901]:



```
df_curate.columns

```










Out\[901]:


```
Index(['EnqueuedTimeSP', 'curationProvider', 'offerId', 'dealerId',
       'uniqueOptionId', 'optionId', 'isMobileDealer', 'isOpen', 'eta',
       'chamaScore', 'productBrand', 'isWinner', 'minimumPrice',
       'maximumPrice', 'dynamicPrice', 'finalPrice', 'defeatPrimaryReason',
       'defeatReasons'],
      dtype='object')
```










In \[902]:



```
[x.title() for x in df_curate.columns]

```










Out\[902]:


```
['Enqueuedtimesp',
 'Curationprovider',
 'Offerid',
 'Dealerid',
 'Uniqueoptionid',
 'Optionid',
 'Ismobiledealer',
 'Isopen',
 'Eta',
 'Chamascore',
 'Productbrand',
 'Iswinner',
 'Minimumprice',
 'Maximumprice',
 'Dynamicprice',
 'Finalprice',
 'Defeatprimaryreason',
 'Defeatreasons']
```










In \[903]:



```
new_column_order = ['curationProvider', 'offerId', 'dealerId',
       'uniqueOptionId', 'optionId', 'isMobileDealer', 'isOpen', 'eta',
       'chamaScore', 'productBrand', 'isWinner', 'minimumPrice',
       'maximumPrice', 'dynamicPrice', 'finalPrice', 'defeatPrimaryReason',
       'defeatReasons', 'EnqueuedTimeSP']
df_curate = df_curate[new_column_order]

```










In \[904]:



```
 = [x.capitalize() for x in df_curate.columns]
# dfdf_curate_colum

```













```

  Cell In[904], line 1
    = [x.capitalize() for x in df_curate.columns]
    ^
SyntaxError: invalid syntax

```










In \[ ]:



```
df_curate.columns

```










In \[804]:



```
new_column_order = ['Curationprovider', 'Offerid', 'Dealerid', 'Uniqueoptionid', 'Optionid',
 'Ismobiledealer',  'Isopen', 'Eta', 'Chamascore', 'Productbrand',
 'Iswinner', 'Minimumprice', 'Maximumprice', 'Dynamicprice', 'Finalprice',
 'Defeatprimaryreason', 'Defeatreasons', 'Enqueuedtimesp']
df_curate = df_curate[new_column_order]

```










In \[ ]:



```
df_curate.fillna('""')

```










In \[ ]:



```
 

```










In \[806]:



```
# save dataframes to csv
df_dynamic_option.to_csv('DynamicPriceOption.csv', index=False)
df_dynamic_range.to_csv('DynamicPriceRange.csv', index=False)
df_curate.to_csv('CuratedOfferOptions.csv', index=False)

```